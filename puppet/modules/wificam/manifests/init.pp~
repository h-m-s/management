class wificam {    
  package { 'git':
    require => Exec['apt-update'],
    ensure => installed,
  }
  package { 'python3-pip':
    require => Exec['apt-update'],
    ensure => installed,
  }
  exec {'log-dir':
    unless => '/usr/bin/test -d /var/log/hms/',
    command => '/bin/mkdir -p /var/log/hms/',
  }
  exec { 'clone-repo':
    unless => '/usr/bin/test -d /root/wificam/',
    command => '/usr/bin/git clone https://github.com/h-m-s/wificam.git',
  }
  exec { 'start-server':
    require => Exec['clone-repo'],
    cwd => '/root/wificam',
    command => '/usr/bin/nohup /usr/bin/python3 /root/wificam/wificam.py &',
  }
}
